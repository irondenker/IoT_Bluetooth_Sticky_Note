# IoT Bluetooth Sticky Note: 스마트폰 연동 전자 포스트잇 (To-Do List Manager)

## 💡 프로젝트 소개

**IoT Bluetooth Sticky Note (전자 포스트잇)** 는 스마트폰의 To-Do List 내용을 블루투스를 통해 받아와 표시하고 관리할 수 있는 소형 IoT 장치입니다. 본 프로젝트는 '전자 계획표'에서 '전자 포스트잇'으로 이름이 변경되었으며, 이는 제품의 정체성을 더욱 명확하게 나타내고자 한 것입니다. 이 장치는 블루투스 통신을 통해 To-Do List를 받아오며, 4개의 저장 공간을 통해 각 줄마다 개별적으로 내용을 저장하고 관리할 수 있습니다.


## 🚀 주요 기능 및 특징

### 표면적 기능

  * **블루투스 To-Do List 수신**: 스마트폰에서 전송된 To-Do List 내용을 블루투스를 통해 받아옵니다. (Android 앱 `Serial Bluetooth Terminal` 권장)
  * **4개 저장 공간**: 디스플레이의 각 줄에 To-Do List 항목을 따로 저장하고 관리합니다.
  * **To-Do 삭제**: 불필요한 To-Do 항목을 쉽게 삭제할 수 있는 기능을 제공합니다. (Key3 버튼)
  * **화면 On/Off**: 필요에 따라 디스플레이를 켜거나 끌 수 있습니다. (Key4 버튼)

### 내부 기능

  * **커서 이동**: '이전' (Key1) 및 '다음' (Key2) 키를 사용하여 현재 설정 중인 To-Do 항목의 커서를 변경할 수 있습니다.
  * **자동 스크롤**: 현재 선택된 To-Do 항목이 20자를 초과할 경우 자동으로 내용을 스크롤하여 전체 내용을 표시합니다.
  * **스크롤 중단**: 스크롤 동작 중에 버튼 입력이나 새로운 블루투스 데이터 수신이 발생하면 스크롤을 멈추고 해당 작업을 처리합니다.
  * **초기화면**: 전원 연결 초기에 "Initializing" 화면을 띄워 장치의 구동 가능 상태를 시각적으로 알립니다.
  * **데이터 형식 변환**: 블루투스로 수신된 데이터를 String 자료형으로 변환하여 처리합니다.
  * **문자열 저장**: 변환된 String 데이터를 현재 선택 중인 줄에 저장합니다.
  * **부분 표시**: 저장된 문자열이 20자를 초과할 경우, 처음 20자만 화면에 분할하여 표시합니다.


## 🛠️ 기술 스택 및 주요 부품

  * **마이크로컨트롤러 보드**: Orangeboard BLE (kocoa fab)
  * **디스플레이**: 20x4 I2C LCD Display
      * 20열, 4행의 블루 백라이트 LCD
      * 압도적으로 저렴한 가격이 장점입니다.
  * **버튼**: 1x4 Membrane Button
      * 단순하고 안정적인 구조로 조작이 쉽습니다.
  * **개발 환경**: Windows 10



## 🗓️ 프로젝트 기간 및 참여 인력

  * **기간**: 2020년 10월 - 2020년 12월
  * **참여 인력**: 설계/시장성 분석/구현/발표 1인(본인, 개인 프로젝트)


## ⚙️ 제작 과정 및 문제 해결 경험

본 프로젝트는 약 9주에 걸쳐 진행되었으며, 초기 구상부터 최종 구현까지 다양한 시행착오와 부품 변경 과정을 거쳤습니다.

### 시기별 핵심 정리

  * **1\~2주차 (구상 단계 - 이상적 방향)**: E-paper 디스플레이, 버튼, DIY 케이스, Orangeboard BLE를 고려했습니다.
  * **3\~7주차 (설계 단계 - 타협점 찾기)**: TFT LCD Touch 디스플레이, OrangeBoard 또는 ESP32, DIY 케이스를 고려하며 현실적인 대안을 모색했습니다.
  * **8\~9주차 (구현 단계 - 현실적 방안)**: 최종적으로 20x4 I2C LCD, OrangeBoard, 1x4 Membrane Button 조합을 확정하고 구현했습니다.

### 주요 실패 요인 및 해결 과정 (개선 성공 여부: O/X)

1.  **E-paper 디스플레이 도입 실패 (X)**:

      * **문제점**: 초기 아이디어와 부합하고 저전력이었으나, 2인치 E-paper가 ₩30,000에 달하는 높은 가격, 터치 기능 제품의 희소성 및 더 비싼 가격, 그리고 Arduino 호환 부품 부족이 문제였습니다. 또한, E-paper 관련 지식 부족으로 인해 비현실적인 학습 및 구현 계획을 세웠습니다.
      * **해결**: 도입을 포기하고 다른 디스플레이 대안을 모색했습니다.

2.  **ESP32 도입 실패 (X)**:

      * **문제점**: ESP32는 Orangeboard보다 작고 Wi-Fi/Bluetooth 내장으로 혁신적인 대안이었으나, TFT LCD 디스플레이와의 호환성 부족 (핀 구성 문제) 및 조교의 "오렌지보드 배제 시 설계 지침 위반" 공지로 인해 도입이 무산되었습니다.
      * **해결**: Orangeboard를 기반으로 추가 부품을 더하는 방식으로 설계를 진행했습니다.

3.  **TFT Touch Display 관련 기능 구현 실패 (X)**:

      * **문제점**: TFT LCD 디스플레이는 새로운 부품이었고, 예제를 참고하며 학습했으나, Touch 부분에서 많은 어려움을 겪었습니다. 13번 포트가 모종의 이유로 작동하지 않아 Touch 기능 구현이 불가능했습니다.
      * **해결**: 터치 기능을 포기하고 물리 버튼 도입으로 선회했습니다.

4.  **TFT Touch Display 도입 대실패 (X)**:

      * **문제점**: 설계 막바지인 7주차에 발생한 치명적인 문제로, TFT LCD 터치 디스플레이 구동 실패 외에 **블루투스 기능 이용 불가**라는 사실을 뒤늦게 깨달았습니다. TFT LCD가 Orangeboard의 블루투스 송수신 핀 (4번, 5번)을 이미 사용하고 있어 별도의 블루투스 모듈 추가도 불가능했습니다.
      * **해결**: 설계 마무리 2주를 앞두고 부품 목록을 전면 교체해야 했습니다.

5.  **부품 소형화 및 맞춤 케이스 제작 실패 (X)**:

      * **문제점**: 3D 프린터 사용이 어려워 기성품 케이스 개조를 고려했으나, 최종적으로 부피가 크고 크기가 맞지 않는 I2C LCD 및 물리 버튼으로 변경되면서 3D 프린터 없이는 적합한 케이스 제작이 불가능해졌습니다.
      * **해결**: 폼보드나 하드보드지로 부품을 고정하여 사용 편의성을 확보하는 수준으로 마무리했습니다.

### 개선 시도 요인 (성공 여부: O/X)

  * **I2C LCD 기반 개발 노선 변경 시도 (O)**: TFT LCD의 치명적인 단점들을 해결하기 위해 I2C LCD와 1x4 멤브레인 버튼으로 부품을 완전히 변경했습니다. 이는 최종 구현에 성공적인 결과를 가져왔습니다.
  * **Touch 기능을 대체할 물리 버튼 도입 시도 (O)**: 1x4 멤브레인 버튼을 도입하여 터치 방식에 비해 크게 불편하지 않은 조작부를 완성했습니다.


## 💰 원가 계산 및 근거

본 프로젝트는 낮은 제조 원가를 강점으로 가집니다.

  * **20x4 I2C LCD Display**: ₩6,200
  * **1x4 Membrane Button**: ₩550
  * **기본 키트+부품**: ₩6,750
  * **총계**: 약 ₩13,500 (배송비 및 사소한 부수 부품 제외)

이전에 개발되었던 유사 컨셉 제품들에 비해 압도적으로 저렴한 단가를 자랑합니다.


## ⚖️ 현실적 제한조건 평가

프로젝트는 다양한 현실적 제한조건을 고려하여 설계 및 구현되었습니다.

### 중립적 조건

  * **산업 표준**: 사용된 모든 부품은 일반적으로 판매되는 부품이며, 사무용 제품이므로 상용화 시 제도적 제약이 크지 않을 것으로 예상됩니다.
  * **윤리성**: 코드 작성 시 외부 소스를 참고한 경우 출처를 명시하여 윤리적 문제가 없습니다.
  * **사회/환경에 미치는 영향**: 별도의 친환경 설계는 없으나, 환경에 유해한 요소도 포함되어 있지 않습니다.

### 빈약한 조건

  * **안전성**: 사용에 위험한 요소는 없으나, 별도의 케이스가 없어 외부 충격에 취약합니다.
  * **미학**: 케이스가 적용되지 않아 내부 부품이 노출된 상태로, 디자인적 요소에서 아쉬운 점이 있습니다.

### 충분한 조건

  * **경제성**: 유사 제품 대비 원가가 매우 저렴합니다.
  * **신뢰성**: 부품 수가 적어 고장 시 테스트 및 교체가 용이하며, 기능이 단순하여 문제 발생 시 디버깅 및 수정이 쉽습니다.


## 🎥 작동 설명 및 데모 영상

### 작동 설명

전자 포스트잇은 안드로이드 스마트폰 앱 `Serial Bluetooth Terminal`을 통해 블루투스 송신을 진행할 수 있습니다.

1.  **앱 다운로드**: Google Play Store에서 `Serial Bluetooth Terminal` 앱을 다운로드합니다.
2.  **블루투스 연결**: 앱 실행 후 '연결' 버튼을 눌러 'Kocoafab\_BLE' 항목을 클릭하여 연결합니다.
3.  **앱 설정 (권장)**: 쾌적한 사용을 위해 앱 초기 화면에서 [왼쪽으로 슬라이드] - [Settings]에 접속하여 다음 슬라이드(PDF 45페이지)의 사진처럼 설정을 조율할 수 있습니다.
      * Newline: `Auto (same as Receive)`
      * Edit mode: `Text`
      * Line delay: `0 ms`
      * Character delay: `0 ms`
      * Local echo: `Show send data in terminal` (활성화)
      * Clear input on send (활성화)
      * Newline: `CR+LF` (Send 탭)
      * Font size: `14`
      * Font style: `Normal`
      * Charset: `UTF-8`
      * Display mode: `Text`
      * Auto scroll to end of buffer (활성화)
      * Show connection messages (활성화)
      * Show timestamps (활성화)
      * Timestamp format: `HH:mm:ss.SSS`
      * Buffer size: `10 kB`

### 데모 영상

본 프로젝트의 작동 시연 영상은 다음 링크에서 확인할 수 있습니다.

  * **UCC 데모 영상**: [https://youtu.be/3JJgvTpsyZw](https://youtu.be/3JJgvTpsyZw)


## 🧑‍💻 소스코드 개요 및 구조

본 프로젝트의 소스코드는 Arduino IDE 환경에서 C++ 기반으로 작성되었습니다.
전체 코드는 크게 헤더, 매크로/초기 설정/전역 변수, `void setup()`, `void loop()` 함수로 구성됩니다.

### 1\. 헤더

  * `SoftwareSerial.h`: 블루투스 및 시리얼 통신 라이브러리로, 핵심 기능인 블루투스 송수신 및 디버깅을 위한 시리얼 통신에 사용됩니다.
  * `LiquidCrystal_I2C.h`: I2C LCD 제어를 위한 필수 라이브러리입니다.
  * `Wire.h`: `LiquidCrystal_I2C.h` 구동을 위한 보조 라이브러리입니다.

### 2\. 매크로/초기 설정/전역 변수

  * **매크로**: 1x4 멤브레인 키보드의 각 버튼(key1: 이전, key2: 다음, key3: 삭제, key4: 화면 전원)을 핀 번호에 할당합니다.
  * **초기 설정**: I2C LCD(`lcd(0x27, 20, 4)`) 및 블루투스 시리얼 통신 객체(`BTSerial(4, 5)`)를 선언합니다.
  * **전역 변수**:
      * `BTString`: 블루투스로 수신된 문자열을 임시 저장합니다.
      * `lcdDisplay[4]`: 각 디스플레이 열에 저장될 문자열을 배열 형태로 관리합니다. (20자 이상도 모두 저장)
      * `eraser`: 화면의 문자열을 지우기 위한 공백 문자열입니다.
      * `nowCol`: 현재 선택 중인 LCD 열의 인덱스를 관리합니다.
      * `onToggle`: 화면 On/Off 상태를 관리하는 변수입니다.

### 3\. `void setup()`

  * 초기 부팅 시 한 번만 실행되는 함수로, 시리얼 및 블루투스 시리얼 개방, LCD 초기화 및 백라이트 켜기, 각 버튼의 `pinMode` 설정 등을 수행합니다.
  * "***Initializing***" 및 "***Please Wait***" 메시지를 띄워 장치의 구동 가능 상태를 알립니다.

### 4\. `void loop()`

  * 장치 구동 중 지속적으로 반복되는 메인 루프입니다.
  * **20자 이상 스크롤 알고리즘**:
      * 선택된 줄의 텍스트가 20자를 초과할 경우, 텍스트의 끝까지 스크롤하여 보여줍니다.
      * 스크롤 중 버튼 입력이나 새로운 블루투스 데이터 수신이 감지되면 즉시 스크롤을 중단하고 `keyControl` 지점으로 이동합니다.
  * **버튼 눌림 여부에 따른 동작 코드 알고리즘**:
      * **Key1 (이전)**: 현재 열(nowCol)의 값을 줄여 이전 줄로 커서를 이동시킵니다.
      * **Key2 (다음)**: 현재 열(nowCol)의 값을 늘려 다음 줄로 커서를 이동시킵니다.
      * **Key3 (삭제)**: 현재 선택된 줄의 문자열 데이터를 초기화하고 화면에서 지웁니다.
      * **Key4 (화면 전원)**: LCD 백라이트와 디스플레이를 켜거나 끄는 토글 기능을 수행합니다.
  * **블루투스 수신 및 String화 알고리즘**:
      * 블루투스 (`BTSerial.available()`)를 통해 수신된 데이터를 `char` 형식으로 변환하고, 이를 `BTString` 변수에 이어붙여 `String` 형식으로 만듭니다.
  * **String 저장 및 디스플레이 제어 알고리즘**:
      * 처리된 `BTString` 값을 현재 `nowCol`에 해당하는 `lcdDisplay` 배열에 저장합니다.
      * 저장된 문자열의 길이가 20자 이하인 경우 그대로 디스플레이에 출력하고, 20자를 초과하는 경우 `substring()` 함수를 사용하여 첫 20자만 `temp` 변수에 저장하여 출력합니다. (원본 데이터는 `lcdDisplay`에 온전히 보존됩니다.)


## ⏭️ 최종 제출물의 실패 및 개선 가능 요인

### 최종 제출물의 실패 요인

  * **아두이노 -\> 스마트폰 문자열 수신**: 4번 버튼을 눌러 각 줄에 저장된 문자열을 스마트폰으로 다시 보내는 기능을 구상했으나, 알 수 없는 이유로 문자열 수신이 되지 않아 해당 기능을 포기했습니다. (현재 4번 버튼은 화면 켜고 끄는 기능으로 대체됨)

### 최종 제출물의 개선 가능 요인

  * **To-Do List 목록 확장 (5개 이상)**: 현재 4개인 To-Do List 수용 공간을 코드를 수정하여 5개 이상으로 늘릴 수 있습니다. 이는 실용성을 높일 것이지만, 안정화 과정에 시간이 소요될 수 있습니다.
  * **To-Do List 부분 수정 기능**: 현재는 To-Do List 내용을 부분적으로 수정하는 기능이 없으며, 전체 삭제 후 재전송해야 합니다. 각 줄의 개별 글자에 접근하여 수정 및 삭제할 수 있는 기능을 추가한다면 완성도가 높아질 것이며, 이는 추가 버튼 설치 및 대규모 코드 수정이 필요한 작업입니다.


## 🔗 프로젝트 링크

  * **GitHub Repository**:[https://github.com/irondenker/IoT_Bluetooth_Sticky_Note](https://github.com/irondenker/IoT_Bluetooth_Sticky_Note)
  * **UCC 데모 영상**: [https://youtu.be/3JJgvTpsyZw](https://youtu.be/3JJgvTpsyZw)
